---
title: HTTP 状态码
tags:
  - web前端
  - 网络基础
categories:
  - 读书笔记
  - 图解HTTP
date: 2020-01-06 11:13:35
---

<style>
table th:first-of-type {
    width: 8%;
}
</style>

# 返回结果的 HTTP 状态码

`HTTP`状态码负责告知对于客户端发起的`HTTP`请求，服务器对应的的返回结果，可以从中得知服务器端是否正确处理了请求或发生了什么错误。

状态码除了可以告知请求状态，还可以帮助开发者根据返回标识判断下一步操作，例如使用`AJAX`进行通信时，可以根据对应的状态码做出对应的操作。

## AJAX 是什么

`AJAX`就是使用`JavaScript`向服务端发起一个请求，获取服务端返回的内容。在`AJAX`发明之前，请求发起会面临**页面刷新**和**请求文件类型局限**两个问题。有了`AJAX`，可以使用该功能向服务端请求任何类型的数据（虽然大多数是返回`JSON`）。

```javascript
var ajaxRequest = new XMLHttpRequest(); // 创建一个对象
// 监听请求成功后的状态变化
ajaxRequest.onreadystatechange = function() {
  if (this.readyState == 4 && this.status == 200) {
    console.log(ajaxRequest.responseText);
  }
};
ajaxRequest.open('Method', 'filename', Boolean); // 设置请求参数
// 当该boolean值为true时，服务器请求是异步进行的，也就是脚本执行send()方法后不等待
// 服务器的执行结果，而是继续执行脚本代码；
// 当该boolean值为false时，服务器请求是同步进行的，也就是脚本执行send()方法后等待
// 服务器的执行结果的返回，若在等待过程中超时，则不再等待，继续执行后面的脚本代码！
ajaxRequest.send(); // 发送请求
```

### readyState 的取值

![](Jietu20200108-113424.jpg)

### status 的取值

这部分就是接下来要总结的状态码了，状态码的数量大概有六十多种，但是经常使用的就十四种左右。

状态码的组成为第一位的响应类别 `+` 后两位表示具体的信息（后两位无类别）。

按照响应类别分类有五种：

|     | 类别                             | 原因短语                   |
| --- | :------------------------------- | :------------------------- |
| 1XX | Informational（信息性状态码）    | 接收的请求正在处理         |
| 2XX | Success（成功状态码）            | 请求正常处理完毕           |
| 3XX | Redirection（重定向状态码）      | 需要进行附加操作以完成请求 |
| 4XX | Client Error（客户端错误状态码） | 服务器无法处理请求         |
| 5XX | Server Error（服务器错误状态码） | 服务器处理请求出错         |

只要遵守文档中状态码类别的定义，由于没有实际的规范对原因短语的确切文本进行说明，后边的两位数字都是可以改的。即使改变 RFC2616 中定义的状态码，或服务器端自行创建状态码都没问题。

## 1XX - 信息性状态码

该类别状态码表示请求已经接收，还需要继续处理。属于临时响应，仅有状态行，部分响应头，并以空行结束。

| 状态码 | 原因短语            | 含义                                                                                               |
| :----- | :------------------ | :------------------------------------------------------------------------------------------------- |
| 100    | Continue            | 说明收到了请求的初始部分，请客户端继续。发送了这个状态码之后，服务器在再次收到请求之后必须进行响应 |
| 101    | Switching Protocols | 说明服务器正在根据客户端的指定，将协议切换成`Update`首部所列的协议                                 |

### 状态码 100

`HTTP`客户端应用程序有一个实体的主体部分要发送给服务器，但希望在发送之前查看一下服务器是否会接受这个实体。

### 状态码 101

> 服务器理解并愿意服从客户端含有`Upgrade`信息头字段的请求，以改变当前连接使用的应用层协议。
> 服务器在响应 101 状态码的最后空行后，将立即切换到响应头中定义的`Upgrade`字段的协议。
> 协议只有在对其有益的前提下才应该切换。例如，切换到一个新的`HTTP`版本比用老版本更有益，切换到一个实时的、同步的协议再使用这些特性传送资源会更优越。

协议升级机制只适用于`HTTP/1.1`，需要在首部添加下面两个属性：

- `Connection: Upgrade`设置`Connection`头的值为`"Upgrade"`来指示这是一个升级请求
- `Upgrade: protocols`：`Upgrade`头指定一项或多项协议名，按优先级排序，以逗号分隔

## 2XX - 成功状态码

该状态码表示服务器已经正常处理请求了。

响应报文与请求方法有关，如果是`GET`请求，对应资源实体会作为响应返回。但使用`HEAD`方法，只在响应中返回首部，不会返回实体部分。

| 状态码 | 原因短语                      | 含义                                                                                                                                                                                                                                                                                        |
| :----- | :---------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 200    | OK                            | 请求没问题，响应实体的主体部分包含了所请求的资源                                                                                                                                                                                                                                            |
| 201    | Created                       | 用于创建服务器对象的请求（比如，PUT）。响应的实体主体部分中应该包含各种引用了已创建的资源的 URL ，`Location`首部包含的则是最具体的引用，指向的是新创建的资源的地址。服务器必须在发送这个状态码之前创建好对象                                                                                |
| 202    | Accepted                      | 请求已被接受，但服务器还未对其执行任何动作。不能保证服务器会完成这个请求；这只是意味着接受请求时，它看起来是有效的。服务器应该在实体的主体部分包含对请求状态的描述，或许还应该有对请求完成时间的估计（或者包含一个指针，指向可以获取此信息的位置）                                          |
| 203    | Non-Authoritative Information | 实体首部包含的信息不是来自于源端服务器，而是来自资源的一份副本。如果中间节点上有一份资源副本，但无法或者没有对它所发送的与资源有关的元信息（首部）进行验证，就会出现这种情况。这种响应码并不是非用不可的；如果实体首部来自源端服务器，响应为 200 状态的应用程序就可以将其作为一种可选项使用 |
| 204    | No Content                    | 响应报文中包含若干首部和一个状态行，但没有实体的主体部分。主要用于在浏览器不转为显示新文档的情况下，对其进行更新（比如刷新一个表单页面），就是客户端往服务器发送信息，但是服务器不需要给返回信息内容，例如发送表单。                                                                        |
| 205    | Reset Content                 | 另一个主要用于浏览器的代码。负责告知浏览器清除当前页面中的所有 HTML 表单元素                                                                                                                                                                                                                |
| 206    | Partial Content               | 成功执行了一个部分或`Range`（范围）请求。客户端可以通过一些特殊的首部来获取部分或某个范围内的文档——这个状态码就说明范围请求成功了。206 响应中必须包含`Content-Range`、`Date`以及`ETag`或`Content-Location`首部                                                                              |

### 200 OK

状态码  **`200 OK`**  表明请求已经成功. 默认情况下状态码为 200 的响应可以被缓存。

不同请求方式对于请求成功的意义如下:

- [`GET`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET 'HTTP GET 方法请求指定的资源。使用 GET 的请求应该只用于获取数据。'): 已经取得资源，并将资源添加到响应的消息体中。
- [`HEAD`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD 'HTTP HEAD 方法 请求资源的头部信息, 并且这些头部与 HTTP GET 方法请求时返回的一致. 该请求方法的一个使用场景是在下载一个大文件前先获取其大小再决定是否要下载, 以此可以节约带宽资源.'):  响应的消息体为头部信息。
- [`POST`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST 'HTTP POST 方法 发送数据给服务器. 请求主体的类型由 Content-Type 首部指定.'):  响应的消息体中包含此次请求的结果。
- [`TRACE`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/TRACE 'HTTP TRACE 方法 实现沿通向目标资源的路径的消息环回（loop-back）测试 ，提供了一种实用的 debug 机制。'): 响应的消息体中包含服务器接收到的请求信息。

[`PUT`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/PUT 'HTTP PUT 请求方法使用请求中的负载创建或者替换目标资源。') 和  [`DELETE`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/DELETE 'HTTP DELETE 请求方法用于删除指定的资源。')  的请求成功通常并不是响应`200` `OK`的状态码而是  [`204`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/204 'HTTP协议中 204 No Content 成功状态响应码表示目前请求成功，但客户端不需要更新其现有页面。204 响应默认是可以被缓存的。在响应中需要包含头信息 ETag。') `No Content`  表示无内容(或者 [`201 Created`](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status/201 '在HTTP协议中，201 Created 是一个代表成功的应答状态码，表示请求已经被成功处理，并且创建了新的资源。新的资源在应答返回之前已经被创建。同时新增的资源会在应答消息体中返回，其地址或者是原始请求的路径，或者是 Location 首部的值。')表示一个资源首次被创建成功)。

## 3XX - 重定向状态码

该响应结果表明浏览器需要执行某些特殊的处理以正确处理请求。

| 状态码 | 原因短语           | 含义                                                                                                                                                                                                                                                                                   |
| :----- | :----------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 300    | Multiple Choices   | 客户端请求一个实际指向多个资源的 URL 时返回这个状态码，比如服务器上有某个 HTML 文档的英语和法语版本。返回这个代码时会带有一个选项列表，这样用户就可以选择他希望使用的那一项了。有多个版本可用时，客户端需要沟通解决。服务器可以在`Location`首部包含首选 URL                            |
| 301    | Moved Permanently  | 在请求的 URL 已被移除时使用。响应的`Location`首部中应该包含资源现在所处的 URL，永久重定向。该状态码表示请求的资源已经被分配到新的 URL                                                                                                                                                  |
| 302    | Found              | 与 301 状态码类似；但是，客户端应该使用`Location`首部给出的 URL 来临时定位资源。将来的请求仍应使用老的 URL，临时重定向，仅本次临时使用新 URL 访问                                                                                                                                      |
| 303    | See Other          | 告知客户端应该用另一个 URL 来获取资源。新的 URL 位于响应报文的 `Location` 首部。主要目的是允许 POST 请求的响应将客户端定向到某个资源上去，返回该状态码明确表示客户端应当采用 GET 方法获取资源。                                                                                        |
| 304    | Not Modified       | 客户端可以通过所包含的请求首部，使其请求变成有条件的。如果客户端发起了一个条件 GET 请求，而最近资源未被修改的话，就可以用这个状态码来说明资源未被修改。带有这个状态码的响应不应该包含实体的主体部分                                                                                    |
| 305    | Use Proxy          | 说明必须通过一个代理来访问资源；代理的位置由`Location`首部给出。很重要的一点是，客户端是相对某个特定资源来解析这条响应的，不能假定所有请求，甚至所有对持有所请求资源的服务器的请求都通过这个代理进行。如果客户端错误地让代理介入了某条请求，可能会引发破坏性的行为，而且会造成安全漏洞 |
| 306    | （未使用）         | 当前未使用                                                                                                                                                                                                                                                                             |
| 307    | Temporary Redirect | 与 301 状态码类似；但客户端应该使用`Location`首部给出的 URL 来临时定位资源。将来的请求应该使用老的 URL                                                                                                                                                                                 |

### 303 See Other

> 当 301、302、303 响应状态码返回时，几乎所有的浏览器都会把 POST 改成 GET ，并删除请求报文内的主体，之后请求会自动再次发送。301、302 标准是禁止将 POST 方法改变成 GET 方法的，但实际使用时大家都会这么做。

303 状态码与 302 状态码的区别在于 303 语义更加明确，就是让客户端使用`GET`方式获取资源。假如使用了`POST`访问某个资源，服务端运行后是希望客户端使用`GET`请求重定向到另一个 URI 上去，返回 303 是最理想的。

### 304 Not Modified

该方法虽然被划分在 3XX 类别中，但是和重定向没有关系。

### 307 Temporart Redirect

临时重定向：该方法与之前重定向的区别就在于该响应会遵照浏览器标准，不会从 POST 变成 GET。但是，对于处理响应时的行为，每种浏览器有可能出现不同的情况。

## 4XX - 客户端错误状态码

`4XX`响应结果说明客户端是发生错误的原因所在。

| 状态码 | 原因短语                        | 含义                                                                                                                                                                                   |
| :----- | :------------------------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 400    | Bad Request                     | 用于告知客户端它发送了一个错误的请求，语法错误                                                                                                                                         |
| 401    | Unauthorized                    | 与适当的首部一同返回，在这些首部中请求客户端在获取对资源的访问权之前，对自己进行认证                                                                                                   |
| 402    | Payment Required                | 现在这个状态码还未使用，但已经被保留，以作未来之用                                                                                                                                     |
| 403    | Forbidden                       | 用于说明请求被服务器拒绝了。如果服务器想说明为什么拒绝请求，可以包含实体的主体部分来对原因进行描述。但这个状态码通常是在服务器不想说明拒绝原因的时候使用的                             |
| 404    | Not Found                       | 用于说明服务器无法找到所请求的 URL。通常会包含一个实体，以便客户端应用程序显示给用户看                                                                                                 |
| 405    | Method Not Allowed              | 发起的请求中带有所请求的 URL 不支持的方法时，使用此状态码。应该在响应中包含`Allow`首部，以告知客户端对所请求的资源可以使用哪些方法                                                     |
| 406    | Not Acceptable                  | 客户端可以指定参数来说明它们愿意接收什么类型的实体。服务器没有与客户端可接受的 URL 相匹配的资源时，使用此代码。通常，服务器会包含一些首部，以便客户端弄清楚为什么请求无法满足          |
| 407    | Proxy Authentication Required   | 与 401 状态码类似，但用于要求对资源进行认证的代理服务器                                                                                                                                |
| 408    | Request Timeout                 | 如果客户端完成请求所花的时间太长，服务器可以回送此状态码，并关闭连接。超时时长随服务器的不同有所不同，但通常对所有的合法请求来说，都是够长的                                           |
| 409    | Conflict                        | 用于说明请求可能在资源上引发的一些冲突。服务器担心请求会引发冲突时，可以发送此状态码。响应中应该包含描述冲突的主体                                                                     |
| 410    | Gone                            | 与 404 类似，只是服务器曾经拥有过此资源。主要用于 Web 站点的维护，这样服务器的管理者就可以在资源被移除的情况下通知客户端了                                                             |
| 411    | Length Required                 | 服务器要求在请求报文中包含`Content-Length`首部时使用                                                                                                                                   |
| 412    | Precondition Failed             | 客户端发起了条件请求，且其中一个条件失败了的时候使用。客户端包含了`Expect`首部时发起的就是条件请求                                                                                     |
| 413    | Request Entity Too Large        | 客户端发送的实体主体部分比服务器能够或者希望处理的要大时，使用此状态码                                                                                                                 |
| 414    | Request URI Too Long            | 客户端所发请求中的请求 URL 比服务器能够或者希望处理的要长时，使用此状态码                                                                                                              |
| 415    | Unsupported Media Type          | 服务器无法理解或无法支持客户端所发实体的内容类型时，使用此状态码                                                                                                                       |
| 416    | Requested Range Not Satisfiable | 请求报文所请求的是指定资源的某个范围，而此范围无效或无法满足时，使用此状态码                                                                                                           |
| 417    | Expectation Failed              | 请求的`Expect`请求首部包含了一个期望，但服务器无法满足此期望时，使用此状态码。如果代理或其他中间应用程序有确切证据说明源端服务器会为某请求产生一个失败的期望，就可以发送这个响应状态码 |

### 400 Bad Request

浏览器会像`200 OK`一样对待该状态码，这句话只能从概念来理解如下：

**HTTP 400 Bad Request**响应状态码表示由于语法无效，服务器无法理解该请求。 客户端不应该在未经修改的情况下重复此请求。

一样对待的表现就是当遇到这俩种状态码时浏览器都不会主动再次请求。

### 401 Unauthorized

返回含有 401 的响应必须包含一个适用于被请求资源的`WWW-Authenticate`首部用以质询（challenge）用户信息。当浏览器初次接收到 401 响应，会弹出认证用的对话窗口。

### 404 Not Found

该状态吗也可以在服务器拒绝请求且不想说明理由的时候使用。

## 5XX - 服务器错误

| 状态码 | 原因短语                   | 含义                                                                                                                            |
| :----- | :------------------------- | :------------------------------------------------------------------------------------------------------------------------------ |
| 500    | Internal Server Error      | 服务器遇到一个妨碍它为请求提供服务的错误时，使用此状态码                                                                        |
| 501    | Not Implemented            | 客户端发起的请求超出服务器的能力范围（比如，使用了服务器不支持的请求方法）时，使用此状态码                                      |
| 502    | Bad Gateway                | 作为代理或网关使用的服务器从请求响应链的下一条链路上收到了一条伪响应（比如，它无法连接到其父网关）时，使用此状态码              |
| 503    | Service Unavailable        | 用来说明服务器现在无法为请求提供服务，但将来可以。如果服务器知道什么时候资源会变为可用的，可以在响应中包含一个`Retry-After`首部 |
| 504    | Gateway Timeout            | 与状态码 408 类似，只是这里的响应来自一个网关或代理，它们在等待另一服务器对其请求进行响应时超时了                               |
| 505    | HTTP Version Not Supported | 服务器收到的请求使用了它无法或不愿支持的协议版本时，使用此状态码。有些服务器应用程序会选择不支持协议的早期版本                  |

### 500 Internal Server Error

表示服务端执行请求发生了错误，错误可能是`Web`应用存在的`bug`或者某些临时故障。

### 503 Service Unavailable

该状态码表示服务器可能暂时处于超负载或者停机维护，现在无法处理请求。
