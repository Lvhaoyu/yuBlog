---
title: 关于博客构建踩过的坑
tags:
  - 博客搭建
categories:
  - 日常分享
date: 2019-09-11 01:12:44
---

之前构建自己的博客是使用 hexo+github 来实现的，最近感觉 github 的博客访问太慢，就将博客转到了阿里云上面，最便宜的云主机一个月大概十来块钱，就这样断断续续花了一个月的时间，终于将博客搭建好了，这期间踩过的坑很多，也查了很多资料，现在博客搭建好了，将整个过程记录下来，也不枉我花费这么多时间。

## hexo 如何放到服务器上

网上的教程很多，我看的是[这个教程](https://www.jianshu.com/p/16b89f4f7136)，这个教程的不好之处是直接使用 root 用户来搭建的 git 服务器，虽然我的服务器只用来放个博客用，但是最好还是要新建一个 git 用户来做这些东西，我推荐大家看[这篇文章](https://segmentfault.com/a/1190000009363890)，这样就可以通过公网 ip 来访问博客了。

## 如何通过域名访问服务器

这个是最麻烦的，由于我是在腾讯云购买的域名，但是我服务器是阿里的，如果是国外的服务器，就没有下面这些操作了。

首先强调一下：阿里云的域名不能直接直接解析腾讯的服务器，反之亦然，这里的域名指的是备案过的，没备案的是没办法使用的，如果使用国内的云服务器提供商，任何一家都需要备案，这个数据不是互通的，下面的操作就是解决如何跨服务商解析域名到服务器的公网 ip。

推荐大家用哪里的服务器，就用哪里的域名，这样会方便很多。

- 将域名在阿里云备案
  - 这个备案其实备案的不是域名，而是和你域名绑定的服务器，如果之前在腾讯备案过域名的话，很快就可以提交备案，大约十个工作日，就可以备案完成了
- 修改腾讯云的 DNS 地址
  - 在腾讯云的工作台中找到域名管理
  - 添加解析`A`记录指向你阿里云的 ip 地址
  - 修改 DNS 为`ns1.alidns.com和ns2.alidns.com`
  - 接下来的操作就和腾讯云无关了
- 在阿里云的**云解析 DNS**菜单中将你的域名添加，之后和腾讯云一样，他会自动给你添加两条记录，使用默认的就可以
- 域名一定不要带前面的`www`，带`www`的在腾讯默认是不让添加的，但是在阿里可以，这个暂时没有影响，但是到后边，影响会很大
- 最后就是要设置服务器的安全组，将对应端口暴露出来，这样才可以访问（文档很详细）
- 如果之前的操作都正确，服务器也备案了，就可以使用你的域名访问博客了

## 将`http`转为`https`

这时你的域名已经可以访问到博客了，但是浏览器在你访问的时候回提示你这个是不安全的链接，这是因为服务器使用的是`http`协议，这里需要将其转为`https`协议，这里推荐[一篇良心好文](https://juejin.im/post/5cd376276fb9a032022232b5)，如果一步一步走下来，正常来说是浏览器是不会提示链接不安全的，但是如果在上面的域名解析步骤加上了`www`之后再申请证书的时候是会报错（DNS problem: SERVFAIL looking up A for ...）的，这个问题就是没有添加 A 记录解析，`SSl`验证没有办法证明你的域名和你的服务器是绑定在一起的，在这个方向上找错误，就可以很快解决了。

## 注意事项

- 我推荐的这几篇文章基本上可以避免很多坑，但是因为自己操作不当造成的错误还是会出现很多，这里给大家提一个建议，看文章一定要先看完，再着手去做，而且要多看两篇，挑一个方法最好的，不要看一篇就直接上手了
- 在云服务器配置这里要多看看一下官方文档，按照官方文档的步骤来，就不容易出问题卡住
- 最后说明一下我使用的服务器系统版本是 ubuntu18.04，hexo 的 next 版本是 6.X，这里注意 next 已经将很多功能都集成了，官方文档里面很详细，不要去搜那些老掉牙的教程分享，官方文档找不到的再去查找其他人怎么做的
